{"version":3,"sources":["common/utils.js","component/pager.js","common/consts.js","component/composedbox.js","component/taskstage.js","component/puzzle.js","component/learn.js","component/dictation.js","component/starter.js","common/ajaxPromise.js","component/logging.js","component/ending.js","component/App.js","serviceWorker.js","index.js"],"names":["randomFrom","lowerValue","upperValue","Math","floor","random","shuffle","word","minlen","s","Set","wl","size","mod","vowels","i","length","add","confusions","indexOf","String","fromCharCode","arr","Object","toConsumableArray","item","splice","countPerfect","criteria","c","_iteratorNormalCompletion","_didIteratorError","_iteratorError","undefined","_step","_iterator","Symbol","iterator","next","done","value","status","err","return","Pager","props","els","Array","total","react_default","a","createElement","key","className","cur","ACHIEVE","normal","wrong","correct","PERF","dict","no","yes","puzzle","COINS","perf","flawed","MESSAGE","error","nodata","timeout","loading","uploading","rest","authFail","uploadFail","usernameInvalid","passwordInvalid","passwordConfirmFail","usernameDuplicated","ULSTATUS","notGoing","going","fail","PATTERN","username","password","ComposedBox","markcls","markicon","_this$props","this","achieve","kind","composed","index_es","icon","PureComponent","TaskStage","_this","classCallCheck","possibleConstructorReturn","getPrototypeOf","call","state","pos","animStatus","reset","tipping","extra","animDur","enabled","tips","player","React","createRef","onChange","bind","assertThisInitialized","reflow","checkComposed","tip","onNewTaskReady","playSound","submit","text","setState","_this2","v","r","tasks","keys","l","min","substring","setTimeout","pl","current","play","_this3","acv","addCoins","nextPos","task","cloneElement","info","innerInput","outerInput","ref","src","audio","pager","react_transition_group","in","appear","classNames","onExited","onEntered","composedbox","Puzzle","Info","puzzleBox","puzzle_PuzzleBox","taskstage","taskData","Fragment","phonetic","onClick","PuzzleBox","shuffled","onChar","backspace","chr","curComposed","len","slice","prevProps","map","idx","puzzle_PuzzlePiece","char","sendChar","PuzzlePiece","e","Learn","progress","showIndicator","playAnim","aniVars","startTime","intervalId","tick","Date","getTime","st","ANITIME","setInterval","clearInterval","dist_default","animate","animationDuration","responsive","lineWidth","progressColor","bgColor","showPercentage","showPercentageSymbol","style","marginBottom","Component","Dictation","Tip","dictation_Info","keyboardInput","dictation_KeyboardInput","KeyboardInput","layoutName","keyboard","kblayout","default","shift","onKeyPress","input","button","clearInput","build_default","layout","theme","display","{bksp}","{enter}","{shift}","{tips}","mergeDisplay","buttonTheme","class","buttons","Starter","start","toggleAnim","anim","color","userName","learned","newTasks","t","join","allTasks","changeUser","ajax","url","method","body","contentType","Promise","resolve","reject","xhr","XMLHttpRequest","open","onload","ev","responseText","onerror","ontimeout","ct","setRequestHeader","send","ajaxPost","TYPE_LOGIN","Logging","type","validateRes","login","alter","nameField","document","forms","user_name","curUser","readOnly","repassword","test","showMessage","preventDefault","f","res","validate","confirm_password","JSON","stringify","name","then","data","after","reason","placeholder","Ending","puzzles","dl","dictations","pg","dg","us","uploadStatus","totalCoins","savedCoins","coins","level","sqrt","cellPadding","toFixed","diamonds","nextrun","doFallible","library","faSpinner","faExclamationTriangle","faGenderless","faStar","faCheck","faTimes","faVolumeUp","faBackspace","faUser","faKey","faPuzzlePiece","faKeyboard","faGem","faCoins","LOADING","NormalTasks","App","stage","message","afterAuth","diamonds_saved","coins_saved","tasksType","taskDataArray","initTasks","nextstage","upload","handleDataReceived","fetch","coming","parse","sortup","file","dataSubmit","dictationTasks","push","taskid","lastrec","hostPath","recs","learnTasks","puzzleTasks","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_this4","curStage","da","msg","totalc","logging","starter","learn","dictation","ending","Boolean","window","location","hostname","match","ReactDOM","render","component_App","getElementById","navigator","serviceWorker","ready","registration","unregister"],"mappings":"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","file":"static/js/main.a40493c7.chunk.js","sourcesContent":["//取得一个整随机数，取值范围为[lowerValue,upperValue]\r\nfunction randomFrom(lowerValue, upperValue) {\r\n    return Math.floor(Math.random() * (upperValue - lowerValue + 1) + lowerValue);\r\n}\r\n\r\nfunction shuffle(word, minlen) {\r\n    let s = new Set(word);\r\n    let wl = s.size;\r\n\r\n    if (wl < minlen) { wl = minlen; }\r\n    let mod = wl % 5;\r\n    if (mod !== 0) { wl = wl + (5 - mod); }\r\n\r\n    const vowels = ['a', 'e', 'i', 'o', 'u'];\r\n\r\n    for (let i = 0; i < vowels.length; i++) {\r\n        if (s.size < wl) {\r\n            s.add(vowels[i]);\r\n        } else {\r\n            break;\r\n        }\r\n    }\r\n\r\n    const confusions = [['c', 'k'], ['i', 'y'], ['k', 'g'], ['l', 'r'], ['m', 'n'],\r\n     ['p', 'b'],['q', 'k'], ['r', 'l'], ['s', 'c'], ['v', 'f'], ['w', 'u'], ['ph', 'f']]\r\n\r\n    for (let i = 0; i < confusions.length; i++) {\r\n        if (s.size < wl) {\r\n            if (word.indexOf(confusions[i][0]) >= 0) {\r\n                s.add(confusions[i][1]);\r\n            }\r\n        } else {\r\n            break;\r\n        }\r\n    }\r\n\r\n    while (s.size < wl) {\r\n        s.add(String.fromCharCode(randomFrom(97, 117)));\r\n    }\r\n\r\n    let arr = [...s];\r\n    let len = arr.length;\r\n    //打乱：从数组中随机取一个数，移至末尾；然后从未移动过的数中再取一个数，移至倒数第二……\r\n    for (let i = len - 1; i > 0; i--) {\r\n        let item = arr.splice(randomFrom(0, i), 1)\r\n        arr.splice(i, 0, item);\r\n    }\r\n\r\n    return arr;\r\n}\r\n\r\nfunction countPerfect(arr, criteria) {\r\n    let c = 0;\r\n\r\n    for (let t of arr) {\r\n        if ((t.status & criteria) === criteria) {\r\n            c++;\r\n        }\r\n    }\r\n\r\n    return c;\r\n}\r\n\r\nexport { shuffle, countPerfect };","import React from 'react';\r\n\r\nfunction Pager(props){\r\n  const els=new Array(props.total);\r\n  for(let i=0;i<props.total;i++){\r\n    els[i]=<span key={'el'+i} className={props.cur===i?'pagerel_active':'pagerel_blur'}>●</span>\r\n  }\r\n  return <div className='pager_box'>{els}</div>\r\n}\r\n\r\nexport default Pager;","//const audioPath = 'http://localhost:4000/sounds/';\r\n//const hostPath = 'http://localhost:4000/';\r\nconst audioPath = '/sounds/';\r\nconst hostPath = '/';\r\n\r\nconst ACHIEVE = {\r\n    normal: -1,\r\n    wrong: 0,\r\n    correct: 1,\r\n    // dictFalse: 1,\r\n    // dictSuccess: 2,\r\n    // puzzleFalse: 4,\r\n    // puzzleSuccess: 8\r\n}\r\n\r\nconst PERF = {\r\n    dict: { no: 1, yes: 2 },\r\n    puzzle: { no: 4, yes: 8 }\r\n}\r\n\r\nconst COINS = {\r\n    dict: { perf: 30, flawed: 15 },\r\n    puzzle: { perf: 15, flawed: 10 } \r\n}\r\n\r\nconst MESSAGE = {\r\n    error: '服务器君遇到了麻烦 : (',\r\n    nodata: '暂时没有东西要学~~',\r\n    timeout: '服务器君久久不理我们 :(',\r\n    loading: '正在载入数据……',\r\n    uploading: '正在上传数据……',\r\n    rest: '今日份练习已完成，休息一下吧！',\r\n    authFail: '登录失败！请检查用户名和密码',\r\n    uploadFail: '上传数据失败',\r\n    usernameInvalid: '用户名须以字母或中文开头，包含3-10个字母、中文和数字',\r\n    passwordInvalid: '密码应包含8-20个字母或数字',\r\n    passwordConfirmFail: '两次输入的密码不一致',\r\n    usernameDuplicated: '用户名已经存在'\r\n}\r\n\r\nconst ULSTATUS = {\r\n    notGoing: 0,\r\n    going: 1,\r\n    fail: 2,\r\n    done: 3\r\n}\r\n\r\nconst PATTERN = {\r\n    username: /^([\\u4E00-\\u9FA5\\uF900-\\uFA2D]|[a-zA-Z]){1}([\\u4E00-\\u9FA5\\uF900-\\uFA2D]|[a-zA-Z0-9]){2,9}$/,\r\n    password: /^[a-zA-Z0-9]{8,20}$/\r\n}\r\n\r\nexport {\r\n    audioPath, hostPath, ACHIEVE, MESSAGE, PATTERN, ULSTATUS, PERF, COINS\r\n};","import React, { PureComponent } from 'react';\r\nimport { ACHIEVE, PERF } from '../common/consts.js'\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\n\r\nclass ComposedBox extends PureComponent {\r\n  // constructor(props) {\r\n  //   super(props);\r\n  // }\r\n\r\n  // componentDidUpdate(prevProps) {\r\n  //   if (this.props.reset) {\r\n  //     this.setState({ shuffled: shuffle(this.props.keys, 10) });\r\n  //   }\r\n  // }\r\n\r\n  render() {\r\n    let markcls = 'colorblack', markicon = 'genderless';\r\n    const {achieve, status}=this.props;\r\n\r\n    if (achieve === ACHIEVE.correct) {\r\n      if (status === PERF[this.props.kind].yes) {\r\n        markcls = 'colorgold';\r\n        markicon = 'star';\r\n      } else {\r\n        markcls = 'colorred';\r\n        markicon = 'check';\r\n      }\r\n    } else if (achieve === ACHIEVE.wrong) {\r\n      markcls = 'colorred';\r\n      markicon = 'times';\r\n    }\r\n\r\n    return (\r\n    <div className='composed_box'>\r\n      <div className='composed_text'>{this.props.composed}</div>\r\n      <div className='mark'><FontAwesomeIcon icon={markicon} className={markcls} /></div>\r\n    </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default ComposedBox;","import React, { PureComponent } from 'react';\r\nimport Pager from './pager.js'\r\nimport ComposedBox from './composedbox.js'\r\nimport { CSSTransition } from 'react-transition-group';\r\nimport { audioPath, ACHIEVE, PERF, COINS } from '../common/consts.js'\r\n\r\nclass TaskStage extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      pos: 0,\r\n      achieve: ACHIEVE.normal,\r\n      composed: '',\r\n      animStatus: true,\r\n      reset: false,\r\n      tipping: false\r\n    }\r\n\r\n    this.extra = {\r\n      status: PERF[props.kind].yes,\r\n      animDur: 1000,\r\n      enabled: true,\r\n      tips:''\r\n    }\r\n\r\n    this.player = React.createRef();\r\n\r\n    this.onChange = this.onChange.bind(this);\r\n    this.reflow = this.reflow.bind(this);\r\n    this.checkComposed = this.checkComposed.bind(this);\r\n    this.tip = this.tip.bind(this);\r\n    this.next = this.next.bind(this);\r\n    this.onNewTaskReady = this.onNewTaskReady.bind(this);\r\n    this.playSound = this.playSound.bind(this);\r\n    this.submit = this.submit.bind(this);\r\n  }\r\n\r\n  onChange(text) {\r\n    if (!this.extra.enabled) { return; }\r\n    this.setState({ achieve: ACHIEVE.normal, composed: text })\r\n  }\r\n\r\n  tip() {\r\n    if (!this.extra.enabled) { return; }\r\n    //看了提示，就不能算一次性成功\r\n    this.extra.status = PERF[this.props.kind].no;\r\n\r\n    const v = this.state.composed;\r\n    const r = this.props.tasks[this.state.pos].keys;\r\n\r\n    let i = 0;\r\n    const l = Math.min(v.length, r.length);\r\n\r\n    for (; i < l; i++) {\r\n      if (r[i] === v[i]) {\r\n        continue\r\n      } else {\r\n        break\r\n      }\r\n    }\r\n\r\n    this.extra.tips = r.substring(0, i + 1) + (i < r.length - 1 ? '~' : '');\r\n\r\n    this.setState({ tipping: true });\r\n    setTimeout(() => { this.setState({ tipping: false }) }, 1000);\r\n  }\r\n\r\n  playSound() {\r\n    let pl = this.player.current;\r\n    pl && pl.play();\r\n  }\r\n\r\n  reflow() {\r\n    this.extra.status = PERF[this.props.kind].yes;\r\n    //this.playSound();\r\n\r\n    this.setState({\r\n      achieve: ACHIEVE.normal,\r\n      composed: '',\r\n      animStatus: true,\r\n      reset: true\r\n    }, () => this.setState({ reset: false }))\r\n  }\r\n\r\n  submit() {\r\n    if (!this.extra.enabled) { return; }\r\n    const acv = this.checkComposed(this.state.composed);\r\n\r\n    if (acv === ACHIEVE.wrong) {\r\n      this.extra.status = PERF[this.props.kind].no;\r\n    }\r\n\r\n    let animStatus = true;\r\n\r\n    if (acv === ACHIEVE.correct) {\r\n      let s = this.props.tasks[this.state.pos].status;\r\n      this.props.tasks[this.state.pos].status = s | this.extra.status;\r\n\r\n      let kind = this.props.kind;\r\n      this.props.addCoins(this.extra.status === PERF[kind].yes ? COINS[kind].perf : COINS[kind].flawed);\r\n      \r\n      animStatus = false;\r\n      this.extra.enabled = false;\r\n    }\r\n\r\n    this.setState({ achieve: acv, animStatus: animStatus });\r\n  }\r\n\r\n  checkComposed(composed) {\r\n    const keys = this.props.tasks[this.state.pos].keys;\r\n\r\n    if (composed === keys) {\r\n      return ACHIEVE.correct;\r\n    } else {\r\n      return ACHIEVE.wrong;\r\n    }\r\n  }\r\n\r\n  next() {\r\n\r\n    const nextPos = this.state.pos + 1;\r\n    if (nextPos < this.props.tasks.length) {\r\n      this.setState({ pos: nextPos }, this.reflow);\r\n    } else {\r\n      this.props.next();\r\n    }\r\n  }\r\n\r\n  onNewTaskReady() {\r\n    this.playSound();\r\n    this.extra.enabled = true;\r\n  }\r\n\r\n  render() {\r\n    const task = this.props.tasks[this.state.pos]\r\n\r\n    const tip = this.props.tip && React.cloneElement(this.props.tip,\r\n      {tipping: this.state.tipping, tips: this.extra.tips});\r\n\r\n    const info = React.cloneElement(this.props.info, \r\n      { task: task, playSound: this.playSound });\r\n\r\n    const innerInput = this.props.innerInput && React.cloneElement(this.props.innerInput,\r\n      { keys: task.keys, reset: this.state.reset, onChange: this.onChange, tip: this.tip, submit: this.submit });\r\n\r\n    const outerInput = this.props.outerInput && React.cloneElement(this.props.outerInput,\r\n      { keys: task.keys, reset: this.state.reset, onChange: this.onChange, tip: this.tip, submit: this.submit });\r\n\r\n    return (\r\n      <div className='content bgpeace'>\r\n        <audio ref={this.player} src={audioPath + task.audio} />\r\n        <Pager total={this.props.tasks.length} cur={this.state.pos} />\r\n        <CSSTransition timeout={this.extra.animDur} in={this.state.animStatus} appear\r\n          classNames='fade' onExited={this.next} onEntered={this.onNewTaskReady}>\r\n          <div className={'min_page'}>\r\n            <ComposedBox composed={this.state.composed} achieve={this.state.achieve}\r\n              status={this.extra.status} kind={this.props.kind} />\r\n            {tip}\r\n            {info}\r\n            {innerInput}\r\n          </div>\r\n        </CSSTransition>\r\n        {outerInput}\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default TaskStage;","import React, { PureComponent } from 'react';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\nimport { shuffle } from \"../common/utils.js\"\r\nimport TaskStage from './taskstage.js'\r\n\r\nclass Puzzle extends PureComponent {\r\n  // constructor(props) {\r\n  //   super(props);\r\n  // }\r\n\r\n  render() {\r\n    const info=<Info />\r\n    const puzzleBox=<PuzzleBox />\r\n    return (\r\n      <TaskStage tasks={this.props.taskData} next={this.props.next} addCoins={this.props.addCoins}\r\n        kind={'puzzle'} info={info} innerInput={puzzleBox}>\r\n      </TaskStage>\r\n    );\r\n  }\r\n}\r\n\r\nfunction Info(props) {\r\n  return (\r\n    <>\r\n      <h3>{props.task.info}</h3>\r\n      <span className='phonetic'>{props.task.phonetic}\r\n        <FontAwesomeIcon icon='volume-up' className='marginleft' onClick={props.playSound} />\r\n      </span>\r\n    </>\r\n  );\r\n}\r\n\r\nclass PuzzleBox extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      shuffled: shuffle(props.keys, 10),\r\n    };\r\n\r\n    this.composed = '';\r\n\r\n    this.onChar = this.onChar.bind(this);\r\n    this.backspace = this.backspace.bind(this);\r\n    // this.submit = this.submit.bind(this);\r\n  }\r\n\r\n  onChar(chr) {\r\n    this.composed = this.composed + chr;\r\n    this.props.onChange(this.composed);\r\n  }\r\n\r\n  backspace() {\r\n    let curComposed = this.composed;\r\n    let len = curComposed.length;\r\n    if (len > 0) {\r\n      this.composed = curComposed.slice(0, len - 1);\r\n      this.props.onChange(this.composed);\r\n    }\r\n  }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.reset) {\r\n      this.setState({ shuffled: shuffle(this.props.keys, 10) });\r\n      this.composed = '';\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className='puzzle_box'>\r\n        {this.state.shuffled.map(\r\n          (chr, idx) => <PuzzlePiece char={chr} key={idx} sendChar={this.onChar} />\r\n        )}\r\n        <button className='btn_bkspc' onClick={this.backspace}>\r\n          <FontAwesomeIcon icon='backspace' />\r\n        </button>\r\n        <button className='submit' onClick={this.props.submit}>提 交</button>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nclass PuzzlePiece extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.onClick = this.onClick.bind(this);\r\n  }\r\n\r\n  onClick = function (e) {\r\n    this.props.sendChar(this.props.char);\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <button className='puzzle_piece' onClick={this.onClick}>\r\n        {this.props.char === \" \" ? \"　\" : this.props.char}</button>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Puzzle;","import React, { Component } from 'react';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\n\r\nimport Circle from 'react-circle';\r\nimport Pager from './pager.js'\r\n\r\nimport { audioPath } from '../common/consts.js'\r\n\r\nconst ANITIME = 3;\r\nconst TICKINTERVAL = 500;\r\n\r\nclass Learn extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      pos: 0,\r\n      progress: 0,\r\n      showIndicator: true,\r\n      playAnim: true\r\n    }\r\n\r\n    this.aniVars = {\r\n      reset: true,\r\n      startTime: 0,\r\n      intervalId: null,\r\n    }\r\n\r\n    this.player = React.createRef();\r\n\r\n    this.next = this.next.bind(this);\r\n    this.playSound = this.playSound.bind(this);\r\n    this.tick = this.tick.bind(this);\r\n  }\r\n\r\n  playSound() {\r\n    let pl = this.player.current;\r\n    pl && pl.play();\r\n  }\r\n\r\n  tick() {\r\n    if (this.aniVars.reset) {\r\n      // if (st === 0) { //最初\r\n      //   this.aniVars.startTime = new Date().getTime();\r\n      //   this.setState({ progress: 0, showIndicator: true, playAnim:false });\r\n      // } else { //Indicator已设为0\r\n      //   this.setState({ progress: 100, playAnim:true });\r\n      //   this.aniVars.reset = false;\r\n      // }\r\n      this.setState({ progress: 100, playAnim: true, showIndicator: true });\r\n      this.aniVars.reset = false;\r\n      this.aniVars.startTime = new Date().getTime();\r\n    } else {\r\n      let st = this.aniVars.startTime;\r\n      if (st !== 0 && new Date().getTime() - st >= ANITIME * 1000) {\r\n        this.setState({ showIndicator: false, progress: 0, playAnim: false })\r\n        this.aniVars.startTime = 0\r\n      }\r\n    }\r\n  }\r\n\r\n  next() {\r\n    this.props.addCoins(5);\r\n\r\n    const nextPos = this.state.pos + 1;\r\n    if (nextPos < this.props.taskData.length) {\r\n      this.aniVars.reset = true;\r\n      this.aniVars.startTime = 0;\r\n      this.setState({ pos: nextPos, showIndicator: true, progress: 0, playAnim: false },\r\n        this.playSound);\r\n    } else {\r\n      this.props.next();\r\n    }\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.playSound();\r\n    this.aniVars.intervalId = setInterval(this.tick, TICKINTERVAL);\r\n  }\r\n\r\n  componentWillUnmount() {\r\n    clearInterval(this.aniVars.intervalId);\r\n  }\r\n\r\n  render() {\r\n    const task = this.props.taskData[this.state.pos];\r\n    return (\r\n      <div className='content bgpeace'>\r\n        <Pager total={this.props.taskData.length} cur={this.state.pos} />\r\n        <div className='min_page'>\r\n          <div className='learn_box'>\r\n            <audio ref={this.player} src={audioPath + task.audio} />\r\n            {this.state.showIndicator ? (<div>\r\n              <Circle animate={this.state.playAnim}\r\n                animationDuration={ANITIME + \"s\"}\r\n                responsive={false}\r\n                size=\"70\"\r\n                lineWidth=\"25\"\r\n                progress={this.state.progress}\r\n                progressColor=\"rgb(76, 154, 255)\"\r\n                bgColor=\"#ecedf0\"\r\n                showPercentage={false}\r\n                showPercentageSymbol={false} />\r\n            </div>) :\r\n              (<><h2>{task.keys}</h2>\r\n                <span className='phonetic'>{task.phonetic}</span>\r\n                <FontAwesomeIcon icon='volume-up' className='marginleft' onClick={this.playSound} /></>)\r\n            }\r\n          </div>\r\n          <div className='fontlarge' style={{marginBottom:\"2rem\"}}>{task.info}</div>\r\n          <div>\r\n            <button className='primary' onClick={this.next}>\r\n              {this.state.showIndicator ? '我会写' : '下一个'}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Learn;","import React, { PureComponent } from 'react';\r\nimport TaskStage from './taskstage.js'\r\n\r\nimport Keyboard from 'react-simple-keyboard';\r\nimport 'react-simple-keyboard/build/css/index.css';\r\n\r\nclass Dictation extends PureComponent {\r\n  // constructor(props) {\r\n  //   super(props);\r\n  // }\r\n\r\n  render() {\r\n    const tip = <Tip />\r\n    const info = <Info />\r\n    const keyboardInput = <KeyboardInput />\r\n    return (\r\n      <TaskStage tasks={this.props.taskData} next={this.props.next} addCoins={this.props.addCoins}\r\n        kind={'dict'} tip={tip} info={info} outerInput={keyboardInput}>\r\n      </TaskStage>\r\n    );\r\n  }\r\n}\r\n\r\nfunction Info(props) {\r\n  return (\r\n    <h3>{props.task.info}</h3>\r\n  );\r\n}\r\n\r\nfunction Tip(props) {\r\n  return (\r\n    <div className={'tip ' + (props.tipping ? 'elvisible' : 'elinvisible')}>\r\n      {props.tips}\r\n    </div>\r\n  )\r\n}\r\n\r\nclass KeyboardInput extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      layoutName: 'default',\r\n    };\r\n\r\n    this.composed = '';\r\n    this.keyboard = React.createRef();\r\n    this.kblayout = {\r\n      'default': [\r\n        'q w e r t y u i o p {bksp}',\r\n        'a s d f g h j k l & \\'',\r\n        'z x c v b n m , . {tips}',\r\n        '{shift} {space} {enter}'\r\n      ],\r\n      'shift': [\r\n        'Q W E R T Y U I O P {bksp}',\r\n        'A S D F G H J K L & \\'',\r\n        'Z X C V B N M , . {tips}',\r\n        '{shift} {space} {enter}'\r\n      ]\r\n    }\r\n\r\n    this.onKeyPress = this.onKeyPress.bind(this);\r\n    this.onChange = this.onChange.bind(this);\r\n    // this.submit = this.submit.bind(this);\r\n  }\r\n\r\n  onChange(input) {\r\n    this.composed = input;\r\n    this.props.onChange(input);\r\n  }\r\n\r\n  onKeyPress(button) {\r\n    if (button === '{enter}') {\r\n      this.props.submit();\r\n      } else if (button === '{tips}') {\r\n        this.props.tip();\r\n    } else if (button === '{shift}') {\r\n      this.setState({ layoutName: this.state.layoutName === 'default' ? 'shift' : 'default' })\r\n    }\r\n  }\r\n\r\n  // submit() {\r\n  //   this.props.submit(this.composed);\r\n  // }\r\n\r\n  componentDidUpdate(prevProps) {\r\n    if (this.props.reset) {\r\n      this.keyboard.current.clearInput();\r\n      this.composed = '';\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <Keyboard ref={this.keyboard}\r\n        layout={this.kblayout}\r\n        theme={'hg-theme-default monofont'}\r\n        display={{ '{bksp}': '←', '{enter}': '提交', '{shift}': '大小写', '{tips}': '提　示'}}\r\n        mergeDisplay={true} onChange={this.onChange}\r\n        onKeyPress={this.onKeyPress}\r\n        layoutName={this.state.layoutName}\r\n        buttonTheme={[\r\n          {\r\n            class: \"hg-button hg-standardBtn submit_key fontnormal\",\r\n            buttons: \"{enter}\"\r\n          },\r\n          {\r\n            class: \"hg-button hg-standardBtn fontnormal\",\r\n            buttons: \"{shift} {tips} \"\r\n          },\r\n        ]}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nexport default Dictation;","import React, { PureComponent } from 'react';\r\n\r\nclass Starter extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.start = this.start.bind(this);\r\n    this.toggleAnim = () => this.setState({ anim: !this.state.anim })\r\n  }\r\n\r\n  start() {\r\n    this.props.start();\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className='content bgpeace'>\r\n        <div className='min_page'>\r\n          <h3 style={{ color: '#A26273' }}>欢迎你，{this.props.userName}</h3>\r\n          <h4>\r\n            你已经学习{this.props.learned}个，还需学习{802 - this.props.learned}个<br /><br />\r\n            本次要学习{this.props.newTasks.length}个新单词:<br />\r\n            {this.props.newTasks.map((t) => { return t.keys }).join(' / ')}<br /><br />\r\n            复习{this.props.allTasks.length - this.props.newTasks.length}个单词。\r\n          </h4>\r\n          <div className='margintop'>\r\n            <button className='primary' onClick={this.start}>Let's Go！</button>\r\n            <button className='marginleft primary' onClick={this.props.changeUser}>切换用户</button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Starter;","function ajax(url, method, body, contentType) {\r\n    var p = new Promise(function (resolve, reject) {\r\n\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.timeout = 10000;\r\n\r\n        xhr.open(method, url, true);\r\n        xhr.onload = function (ev) {\r\n            resolve(this.responseText);\r\n        }\r\n        //onerror似乎不起作用\r\n        xhr.onerror = function (ev) { reject('error') }\r\n        xhr.ontimeout = function (ev) { reject('timeout') }\r\n\r\n        let ct = 'text/plain;charset=utf-8'\r\n        if (contentType === 'json') { ct = 'application/json;charset=utf-8' }\r\n        else if (contentType === 'xform') { ct = 'application/x-www-form-urlencoded;charset=utf-8' }\r\n        xhr.setRequestHeader('content-type', ct)\r\n\r\n        xhr.send(body);\r\n    });\r\n    return p;\r\n}\r\n\r\nfunction ajaxGet(url) {\r\n    return ajax(url, 'GET')\r\n}\r\n\r\nfunction ajaxPost(url, body, contentType) {\r\n    return ajax(url, 'POST', body, contentType)\r\n}\r\n\r\nexport { ajaxGet, ajaxPost };","import React, { Component } from 'react';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome';\r\n\r\nimport { ajaxPost } from '../common/ajaxPromise.js';\r\nimport { hostPath, MESSAGE, PATTERN } from '../common/consts.js';\r\n\r\nconst TYPE_LOGIN = 0, TYPE_SIGNUP = 1;\r\n\r\nclass Logging extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n\r\n    this.state = {\r\n      type: TYPE_LOGIN,\r\n      validateRes: '　'//全角空格，用于占位\r\n    }\r\n\r\n    this.login = this.login.bind(this);\r\n    this.alter = this.alter.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n    let nameField = document.forms['logging'].user_name;\r\n    if (this.props.curUser !== '') {\r\n      nameField.value = this.props.curUser;\r\n      nameField.readOnly = true;\r\n    }\r\n  }\r\n\r\n  validate(username, password, repassword) {\r\n\r\n    if (!PATTERN.username.test(username)) {\r\n      return MESSAGE.usernameInvalid;\r\n    }\r\n    if (!PATTERN.password.test(password)) {\r\n      return MESSAGE.passwordInvalid;\r\n    }\r\n    if (repassword && password !== repassword) {\r\n      return MESSAGE.passwordConfirmFail;\r\n    }\r\n\r\n    return 'OK';\r\n  }\r\n\r\n  alter() {\r\n    if (this.state.type === TYPE_LOGIN) {\r\n      this.setState({ type: TYPE_SIGNUP })\r\n    } else {\r\n      this.setState({ type: TYPE_LOGIN })\r\n    }\r\n    this.props.showMessage('');\r\n  }\r\n\r\n  login(e) {\r\n    e.preventDefault();\r\n\r\n    const f = document.forms['logging']\r\n\r\n    const username = f.user_name.value;\r\n    const password = f.password.value;\r\n\r\n    let res = '';\r\n    if (this.state.type === TYPE_LOGIN) {\r\n      res = this.validate(username, password);\r\n    } else {\r\n      res = this.validate(username, password, f.confirm_password.value);\r\n    }\r\n\r\n    if (res !== 'OK') {\r\n      this.setState({ validateRes: res });\r\n      return;\r\n    } else {\r\n      this.setState({ validateRes: '　' })\r\n    }\r\n\r\n    ajaxPost(hostPath + (this.state.type === TYPE_LOGIN ? 'login' : 'logup'),\r\n      JSON.stringify({\r\n        name: username,\r\n        password: password\r\n      }),\r\n      'json').then(\r\n        (data) => {\r\n          if (data === 'duplicated') {\r\n            this.props.showMessage(MESSAGE.usernameDuplicated);\r\n          } else if (data === 'OK') {\r\n            this.props.showMessage('');\r\n            this.props.after();\r\n          } else {\r\n            this.props.showMessage(MESSAGE.authFail);\r\n          }\r\n        },\r\n        (reason) => {\r\n          this.props.showMessage(MESSAGE[reason]);\r\n        }\r\n      )\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div className='content bgpeace'>\r\n        <div className='min_page'>\r\n          <div className='fontlarge marginbottom'>\r\n            {this.state.type === TYPE_LOGIN ? '登　录' : '注　册'}\r\n          </div>\r\n          <br />\r\n          <form name='logging'>\r\n            <div className='input_wrapper'>\r\n              <span className='iconlabel'><FontAwesomeIcon icon='user' /></span>\r\n              <input className='loginput' type='text' name='user_name' placeholder='用户名' />\r\n            </div>\r\n            <div className='input_wrapper'>\r\n              <span className='iconlabel'><FontAwesomeIcon icon='key' /></span>\r\n              <input className='loginput' type='password' name='password' placeholder='密码'/>\r\n            </div>\r\n            <div className={'input_wrapper ' + (this.state.type === TYPE_SIGNUP ? 'elvisible' : 'elinvisible')}>\r\n              <span className='iconlabel'> <FontAwesomeIcon icon='key' /></span>\r\n              <input className='loginput' type='password' name='confirm_password' placeholder='重复密码'/>\r\n            </div>\r\n\r\n            <div className='marginbottom fontsmall colorred'>{this.state.validateRes}</div>\r\n            <div className='button_group'>\r\n              <button onClick={this.login} className='primary'>\r\n                {this.state.type === TYPE_LOGIN ? '登　录' : '注　册'}\r\n              </button>\r\n              {\r\n                this.props.curUser === '' && <span className='marginleft cursordefault fontsmall'\r\n                  onClick={this.alter}>\r\n                  {this.state.type === TYPE_LOGIN ? '注  册' : '登  录'}</span>\r\n              }\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Logging;","import React, { PureComponent } from 'react';\r\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\r\n\r\nimport {PERF, ULSTATUS } from '../common/consts.js'\r\nimport { countPerfect } from \"../common/utils.js\"\r\n\r\nclass Ending extends PureComponent {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n    }\r\n  }\r\n\r\n  render() {\r\n    let pl = this.props.puzzles.length;\r\n    let dl = this.props.dictations.length;\r\n\r\n    let pg = countPerfect(this.props.puzzles, PERF.puzzle.yes);\r\n    let dg = countPerfect(this.props.dictations, PERF.dict.yes);\r\n\r\n    let us = this.props.uploadStatus;\r\n    let totalCoins = this.props.savedCoins + this.props.coins;\r\n    let level = Math.floor(Math.sqrt(2500 + 200 * totalCoins - 50) / 100);\r\n\r\n    return (\r\n      <div className='content bgpeace'>\r\n        <div className='min_page'>\r\n          {us === ULSTATUS.going && <FontAwesomeIcon icon='spinner' className='load_ani fontextralarge' />}\r\n          {us === ULSTATUS.fail && <FontAwesomeIcon icon='exclamation-triangle' className='colorred fontextralarge' />}\r\n          {us === ULSTATUS.done && <div>\r\n            <h3>你已完成本轮练习！</h3>\r\n            <table cellPadding='10px'><tbody>\r\n              <tr><td>本轮胜率</td></tr>\r\n              <tr>{pl !== 0 && <td><FontAwesomeIcon icon='puzzle-piece' /> {pg}/{pl} {(pg / pl * 100).toFixed(0)}%</td>}\r\n                <td><FontAwesomeIcon icon='keyboard' /> {dg}/{dl} {(dg / dl * 100).toFixed(0)}%</td>\r\n              </tr>\r\n              <tr><td>获得财富</td></tr>\r\n              <tr>\r\n                <td><FontAwesomeIcon icon='coins' /> {this.props.coins}个</td>\r\n                <td><FontAwesomeIcon icon='gem' /> {this.props.diamonds}个</td>\r\n              </tr>\r\n              <tr>\r\n                <td>目前级别</td><td>{level}级</td>\r\n              </tr>\r\n            </tbody></table>\r\n            <button className='primary' onClick={this.props.nextrun}>再来一轮吧</button>\r\n            <button className='primary marginleft' onClick={this.props.doFallible}>复习易错题</button>\r\n          </div>}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Ending;","import React, { Component } from 'react';\n\nimport Puzzle from './puzzle.js'\nimport Learn from './learn.js'\nimport Dictation from './dictation.js'\nimport Starter from './starter.js'\nimport Logging from './logging.js'\nimport Ending from './ending.js'\n\nimport { ajaxGet, ajaxPost } from '../common/ajaxPromise.js';\nimport { countPerfect } from '../common/utils.js'\nimport { hostPath, MESSAGE, ULSTATUS, PERF } from '../common/consts.js'\n\nimport { library } from '@fortawesome/fontawesome-svg-core'\nimport {\n  faSpinner, faExclamationTriangle, faGenderless, faStar, faCheck, faTimes, faVolumeUp,\n  faBackspace, faUser, faKey, faPuzzlePiece, faKeyboard, faGem, faCoins\n}\n  from '@fortawesome/free-solid-svg-icons'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\n\nlibrary.add(faSpinner, faExclamationTriangle, faGenderless, faStar, faCheck, faTimes,\n  faVolumeUp, faBackspace, faUser, faKey, faPuzzlePiece, faKeyboard, faGem, faCoins);\n\nconst LOADING = -3, LOGGING = -2,\n  STARTER = -1, LEARN = 0, PUZZLE = 1, DICTATION = 2, ENDING = 3;\n\nconst AllSorts = 0, PuzzleDictation = 1, OnlyDictation = 2;\n\nconst NormalTasks = 0, FallibleTasks = 1;\n\nclass App extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      stage: LOADING,\n      message: '',\n      learned: 0,\n      diamonds: 0,\n      coins: 0,\n      uploadStatus: ULSTATUS.notGoing,\n    };\n    this.extra = {\n      userName: '',\n      afterAuth: null,\n      diamonds_saved: 0,\n      coins_saved: 0,\n      tasksType: NormalTasks\n    };\n    this.taskDataArray = new Array(3);\n    //此句可删\n    this.initTasks();\n\n    this.nextstage = this.nextstage.bind(this);\n    this.upload = this.upload.bind(this);\n    this.handleDataReceived = this.handleDataReceived.bind(this);\n    this.fetch = this.fetch.bind(this);\n    this.changeUser = this.changeUser.bind(this);\n    this.showMessage = this.showMessage.bind(this);\n    this.addCoins = this.addCoins.bind(this);\n    this.nextrun = this.nextrun.bind(this);\n    this.doFallible = this.doFallible.bind(this);\n  }\n\n  handleDataReceived(data) {\n    //XMLHttpRequest的onerror似乎不起作用，防止其他错误的返回也有data\n    let coming = null;\n    try {\n      coming = JSON.parse(data);\n    } catch (err) {\n      this.setState({ message: MESSAGE.error });\n      return;\n    }\n    this.sortup(coming.data);\n\n    this.extra.userName = coming.username;\n    this.extra.diamonds_saved = coming.diamonds;\n    this.extra.coins_saved = coming.coins;\n\n    this.setState({ stage: STARTER, learned: coming.learned, coins: 0, diamonds: 0 })\n    //this.setState({ stage: DICTATION })}\n  }\n\n\n  fetch() {\n    this.extra.afterAuth = this.fetch;\n    this.initTasks();\n\n    let file = (this.extra.tasksType === FallibleTasks) ? 'fallible.json' : 'data.json';\n\n    ajaxGet(hostPath + file).then(\n      (data) => {\n        if (data === 'unauth') {\n          this.extra.afterAuth = this.fetch;\n          this.setState({ stage: LOGGING });\n          return;\n        } else if (data === 'nodata') {\n          this.setState({ message: MESSAGE.nodata });\n          return;\n        }\n\n        this.handleDataReceived(data);\n\n      },\n      (reason) => {\n        this.setState({ message: MESSAGE[reason] });\n      }\n    )\n  }\n\n  upload() {\n    this.extra.afterAuth = this.upload;\n\n    const dataSubmit = []\n    for (let t of this.dictationTasks) {\n      dataSubmit.push({ taskid: t.taskid, status: t.status, lastrec: t.lastrec })\n    }\n\n    this.setState({ message: MESSAGE.uploading, uploadStatus: ULSTATUS.going });\n\n    ajaxPost(hostPath + 'submit', JSON.stringify({\n      username: this.extra.userName,\n      coins: this.state.coins,\n      diamonds: this.state.diamonds,\n      recs: dataSubmit\n    }), 'json').then(\n      (data) => {\n        if (data === 'OK') {\n          this.setState({ message: '', uploadStatus: ULSTATUS.done })\n        } else if (data === 'unauth') {\n          this.setState({ message: '', stage: LOGGING })\n        } //else if (data === 'userdismatch'){} //暂无处理\n        else {\n          this.setState({ message: MESSAGE.uploadFail, uploadStatus: ULSTATUS.fail })\n        }\n      },\n      (reason) => { this.setState({ message: MESSAGE[reason], uploadStatus: ULSTATUS.fail }); }\n    )\n  }\n\n  initTasks() {\n    this.learnTasks = [];\n    this.puzzleTasks = [];\n    this.dictationTasks = [];\n\n    this.taskDataArray[LEARN] = this.learnTasks;\n    this.taskDataArray[PUZZLE] = this.puzzleTasks;\n    this.taskDataArray[DICTATION] = this.dictationTasks;\n  }\n\n  sortup(taskData) {\n    for (let t of taskData) {\n      t.status = 0;\n      if (t.kind === AllSorts) {\n        this.learnTasks.push(t);\n        this.puzzleTasks.push(t);\n        this.dictationTasks.push(t);\n      } else if (t.kind === PuzzleDictation) {\n        this.puzzleTasks.push(t);\n        this.dictationTasks.push(t);\n      } else if (t.kind === OnlyDictation) {\n        this.dictationTasks.push(t);\n      }\n    }\n  }\n\n  changeUser() {\n    this.extra.userName = '';\n    this.extra.afterAuth = this.fetch;\n    this.extra.tasksType = NormalTasks;\n    this.setState({ stage: LOGGING })\n  }\n\n  nextstage() {\n\n    let curStage = this.state.stage;\n    let da = this.state.diamonds;\n\n    if (curStage === PUZZLE &&\n      countPerfect(this.puzzleTasks, PERF.puzzle.yes) === this.puzzleTasks.length) {\n      da += 1;\n    } else if (curStage === DICTATION &&\n      countPerfect(this.dictationTasks, PERF.dict.yes) === this.dictationTasks.length) {\n      da += 2;\n    }\n\n    while (curStage < ENDING) {\n      curStage++;\n      if (curStage === ENDING) {\n        break;\n      } else if (this.taskDataArray[curStage].length > 0) {\n        break;\n      }\n    }\n    this.setState({ diamonds: da, stage: curStage },\n      () => { if (curStage === ENDING) { this.upload(); } });\n  }\n\n  nextrun() {\n    this.setState({\n      stage: LOADING,\n      message: '',\n      uploadStatus: ULSTATUS.notGoing\n    });\n    this.extra.tasksType = NormalTasks;\n    this.fetch();\n  }\n\n  doFallible() {\n    this.setState({\n      stage: LOADING,\n      message: '',\n      uploadStatus: ULSTATUS.notGoing\n    });\n    this.extra.tasksType = FallibleTasks;\n    this.fetch();\n  }\n\n  showMessage(msg) {\n    this.setState({ message: msg });\n  }\n\n  addCoins(c) {\n    let totalc = this.state.coins + c;\n    this.setState({ coins: totalc })\n  }\n\n  componentDidMount() {\n    this.fetch();\n  }\n\n  render() {\n\n    let stage = null;\n    let ss = this.state.stage;\n\n    switch (ss) {\n      case LOADING:\n        stage = <div className='content bgpeace'>\n          <div className='min_page fontextralarge'>\n            {this.state.message === '' ? <FontAwesomeIcon icon='spinner' className='load_ani' /> :\n              <>\n                <FontAwesomeIcon icon='exclamation-triangle' className='colorred' />\n                {this.extra.tasksType === FallibleTasks &&\n                  <div>\n                    <button className='primary' onClick={this.nextrun}>做普通任务</button>\n                  </div>}\n              </>\n            }\n          </div>\n        </div>\n        break;\n      case LOGGING:\n        stage = <Logging after={this.extra.afterAuth} curUser={this.extra.userName}\n          showMessage={this.showMessage} />\n        break;\n      case STARTER:\n        stage = <Starter start={this.nextstage} userName={this.extra.userName}\n          newTasks={this.learnTasks} allTasks={this.dictationTasks}\n          changeUser={this.changeUser} learned={this.state.learned} />\n        break;\n      case LEARN:\n        stage = <Learn next={this.nextstage} addCoins={this.addCoins}\n          taskData={this.learnTasks} />\n        break;\n      case PUZZLE:\n        stage = <Puzzle next={this.nextstage} addCoins={this.addCoins}\n          taskData={this.puzzleTasks} />\n        break;\n      case DICTATION:\n        stage = <Dictation next={this.nextstage} addCoins={this.addCoins}\n          taskData={this.dictationTasks} />\n        break;\n      case ENDING:\n        stage = <Ending uploadStatus={this.state.uploadStatus} puzzles={this.puzzleTasks}\n          dictations={this.dictationTasks} nextrun={this.nextrun} doFallible={this.doFallible}\n          coins={this.state.coins} diamonds={this.state.diamonds} savedCoins={this.extra.coins_saved} />\n        break;\n      default:\n    }\n    return (\n      <div className={'app'}>\n        <div className='header colorwhite'>\n          <FontAwesomeIcon icon='coins' /> {this.extra.coins_saved + this.state.coins}\n          <FontAwesomeIcon icon='gem' className='marginleft' /> {this.extra.diamonds_saved + this.state.diamonds}\n        </div>\n        {this.state.message &&\n          <div className={'bgwarn message_bar'}>{this.state.message}</div>}\n        {stage}\n        {/* <div className='footer'>\n          footer\n        </div> */}\n      </div>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read http://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit http://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See http://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './css/custom.css';\nimport App from './component/App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: http://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}